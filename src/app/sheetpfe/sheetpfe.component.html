<div class="row">
  <div class="card" *ngIf="notFound ; else found">
    <div class="card-body">
      <img [src]="notFound" class="img_404">
    </div>
  </div>
  <ng-template #found>
    <div class="col-lg-12" *ngIf="user.role === 'Etudiant'">
     <app-show-sheetpfe></app-show-sheetpfe>
    </div>
    <div class="col-lg-12" *ngIf="user.role != 'Etudiant'">
      <div class="card">
        <div class="card-body">
          <h4 class="card-title">List Sheet PFE</h4>
        </div>
        <div class="card-body">
          <div class="nav-filter" *ngIf="user.role === 'DirecteurDesStages' && !param">
            <div class="row grid-margin">
              <div class="col-sm-6 col-md-4 col-lg-3">
                <select class="form-control" [(ngModel)]="etat" (change)="getSheetPFEs()">
                  <option value="ALL">ALL</option>
                  <option value="DEFAULT">Default</option>
                  <option value="REFUSE">Refuse</option>
                  <option value="ACCEPTED">Accepted</option>
                  <option value="PRE_VALIDATE">Pre_validate</option>
                  <option value="VALIDATE">Validate</option>
                </select>
              </div>
              <div class="col-sm-6 col-md-4 col-lg-3">
                <input type="month" class="form-control" [(ngModel)]="year" (change)="getSheetPFEs()"></div>
              <div class="col-sm-6 col-md-4 col-lg-3">
                <select class="form-control"  [(ngModel)]="pays" (change)="getSheetPFEs()">
                  <option value="ALL">choice entreprise</option>
                  <option *ngFor="let entreprise of entreprises" [ngValue]="entreprise.pays"> {{ entreprise.nameEntreprise }} </option>
                </select>
              </div>
              <div class="col-sm-6 col-md-4 col-lg-3">
                <select class="form-control" [(ngModel)]="categorie" (change)="getSheetPFEs()">
                  <option value="0">choice categorie</option>
                  <option *ngFor="let categorie of categories" [ngValue]="categorie.id"> {{ categorie.name }} </option>
                </select>
              </div>
            </div>
            <button class="btn btn-inverse-info btn-fw grid-margin" type="button" (click)="reset()">Reset</button>
          </div>
          <div class="nav-filter" *ngIf="user.role === 'Enseignant' && !param">
            <div class="row grid-margin">
              <div class="col-sm-6 col-md-4 col-lg-3">
                <select class="form-control" [(ngModel)]="type" (change)="getSheetPFEs()">
                  <option value="ALL">ALL</option>
                  <option value="VALIDATEUR">To Validated</option>
                  <option value="ENCADREUR">To Encadred</option>
                  <option value="RAPPORTEUR">To reported</option>
                </select>
              </div>
              <div class="col-sm-6 col-md-4 col-lg-3">
                <input type="month" class="form-control" [(ngModel)]="year" (change)="getSheetPFEs()">
              </div>
              <div class="col-sm-6 col-md-4 col-lg-3">
                <input type="month" class="form-control" [(ngModel)]="toyear" (change)="getSheetPFEs()">
              </div>
            </div>
            <button class="btn btn-inverse-info btn-fw grid-margin" type="button" (click)="reset()">Reset</button>
          </div>
          <div class="table-responsive">
            <table class="table table-striped">
              <thead>
              <tr>
                <th *ngIf="user.role === 'Enseignant' && type === 'ALL' && param != '_modify'"></th>
                <th>
                  Fiche PFE
                </th>
                <th>
                  Etudiant
                </th>
                <th>
                  Entreprise
                </th>
                <th>
                  Etat
                </th>
                <th>
                  Action
                </th>
              </tr>
              </thead>
              <tbody>
              <tr *ngFor="let sheet of sheets">
                <td *ngIf="user.role === 'Enseignant' && type === 'ALL' && param != '_modify'" class="text-warning" [innerText]="enseignantType(sheet)">
                </td>
                <td class="py-1">
                  {{ sheet.title }}
                </td>
                <td>
                  {{ sheet.etudiant.prenom }} {{ sheet.etudiant.nom }}
                </td>
                <td>
                  {{ sheet.entreprise.nameEntreprise }}
                </td>
                <td>
                  <span class="text-info">{{ sheet.etat }}</span>
                </td>
                <td>
                  <button class="btn btn-primary" [routerLink]="['.',sheet.id]" *ngIf="user.role === 'ChefDeDepartement'">
                    <span *ngIf="param === 'accepted'">Affecter Validateur </span>
                    <span *ngIf="param === 'waitEncadreur'">Affecter Encadreur</span>
                    <span *ngIf="param === 'waitRapporter'">Affecter Rapporteur</span>
                    <span *ngIf="param === 'waitNote'">Show</span>
                  </button>
                  <button class="btn btn-primary" [routerLink]="['.',sheet.id]" *ngIf="user.role === 'DirecteurDesStages' || user.role === 'Enseignant' ">Show</button>
                </td>
              </tr>
              <tr *ngIf="sheets.length === 0" class="text-center">
                <td colspan="5" >
                  There are no sheets
                </td>
              </tr>
              </tbody>
            </table>
          </div>
        </div>
      </div>
    </div>
  </ng-template>
</div>

